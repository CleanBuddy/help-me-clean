type ChatRoom {
  id: ID!
  booking: Booking
  roomType: String!
  participants: [ChatParticipant!]!
  messages(first: Int, after: String): ChatMessageConnection!
  lastMessage: ChatMessage
  createdAt: DateTime!
}

type ChatParticipant {
  user: User!
  joinedAt: DateTime!
}

type ChatMessage {
  id: ID!
  sender: User!
  content: String!
  messageType: String!
  isRead: Boolean!
  createdAt: DateTime!
}

type ChatMessageConnection {
  edges: [ChatMessage!]!
  pageInfo: PageInfo!
}

extend type Query {
  myChatRooms: [ChatRoom!]!
  chatRoom(id: ID!): ChatRoom!
}

extend type Mutation {
  sendMessage(roomId: ID!, content: String!, messageType: String): ChatMessage!
  markMessagesAsRead(roomId: ID!): Boolean!
  createAdminChatRoom(userIds: [ID!]!): ChatRoom!
  openBookingChat(bookingId: ID!): ChatRoom!
}

extend type Subscription {
  messageSent(roomId: ID!): ChatMessage!
  bookingUpdated(bookingId: ID!): Booking!
  notificationReceived: Notification!
}
