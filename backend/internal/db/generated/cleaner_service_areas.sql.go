// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc v1.30.0
// source: cleaner_service_areas.sql

package db

import (
	"context"

	"github.com/jackc/pgx/v5/pgtype"
)

const deleteAllCleanerServiceAreas = `-- name: DeleteAllCleanerServiceAreas :exec
DELETE FROM cleaner_service_areas WHERE cleaner_id = $1
`

func (q *Queries) DeleteAllCleanerServiceAreas(ctx context.Context, cleanerID pgtype.UUID) error {
	_, err := q.db.Exec(ctx, deleteAllCleanerServiceAreas, cleanerID)
	return err
}

const insertCleanerServiceArea = `-- name: InsertCleanerServiceArea :one
INSERT INTO cleaner_service_areas (cleaner_id, city_area_id)
VALUES ($1, $2)
RETURNING id, cleaner_id, city_area_id, created_at
`

type InsertCleanerServiceAreaParams struct {
	CleanerID  pgtype.UUID `json:"cleaner_id"`
	CityAreaID pgtype.UUID `json:"city_area_id"`
}

func (q *Queries) InsertCleanerServiceArea(ctx context.Context, arg InsertCleanerServiceAreaParams) (CleanerServiceArea, error) {
	row := q.db.QueryRow(ctx, insertCleanerServiceArea, arg.CleanerID, arg.CityAreaID)
	var i CleanerServiceArea
	err := row.Scan(
		&i.ID,
		&i.CleanerID,
		&i.CityAreaID,
		&i.CreatedAt,
	)
	return i, err
}

const listCleanerServiceAreas = `-- name: ListCleanerServiceAreas :many
SELECT csa.id, csa.cleaner_id, csa.city_area_id, csa.created_at,
       ca.name AS area_name, ca.city_id, ec.name AS city_name
FROM cleaner_service_areas csa
JOIN city_areas ca ON ca.id = csa.city_area_id
JOIN enabled_cities ec ON ec.id = ca.city_id
WHERE csa.cleaner_id = $1
ORDER BY ec.name, ca.name
`

type ListCleanerServiceAreasRow struct {
	ID         pgtype.UUID        `json:"id"`
	CleanerID  pgtype.UUID        `json:"cleaner_id"`
	CityAreaID pgtype.UUID        `json:"city_area_id"`
	CreatedAt  pgtype.Timestamptz `json:"created_at"`
	AreaName   string             `json:"area_name"`
	CityID     pgtype.UUID        `json:"city_id"`
	CityName   string             `json:"city_name"`
}

func (q *Queries) ListCleanerServiceAreas(ctx context.Context, cleanerID pgtype.UUID) ([]ListCleanerServiceAreasRow, error) {
	rows, err := q.db.Query(ctx, listCleanerServiceAreas, cleanerID)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []ListCleanerServiceAreasRow
	for rows.Next() {
		var i ListCleanerServiceAreasRow
		if err := rows.Scan(
			&i.ID,
			&i.CleanerID,
			&i.CityAreaID,
			&i.CreatedAt,
			&i.AreaName,
			&i.CityID,
			&i.CityName,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}
