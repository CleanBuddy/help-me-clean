// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc v1.30.0
// source: personality_assessments.sql

package db

import (
	"context"

	"github.com/jackc/pgx/v5/pgtype"
)

const createPersonalityAnswer = `-- name: CreatePersonalityAnswer :exec
INSERT INTO personality_assessment_answers (
    assessment_id, question_number, facet_code,
    is_reverse_keyed, raw_response, scored_value
) VALUES ($1, $2, $3, $4, $5, $6)
`

type CreatePersonalityAnswerParams struct {
	AssessmentID   pgtype.UUID `json:"assessment_id"`
	QuestionNumber int32       `json:"question_number"`
	FacetCode      string      `json:"facet_code"`
	IsReverseKeyed bool        `json:"is_reverse_keyed"`
	RawResponse    int32       `json:"raw_response"`
	ScoredValue    int32       `json:"scored_value"`
}

func (q *Queries) CreatePersonalityAnswer(ctx context.Context, arg CreatePersonalityAnswerParams) error {
	_, err := q.db.Exec(ctx, createPersonalityAnswer,
		arg.AssessmentID,
		arg.QuestionNumber,
		arg.FacetCode,
		arg.IsReverseKeyed,
		arg.RawResponse,
		arg.ScoredValue,
	)
	return err
}

const createPersonalityAssessment = `-- name: CreatePersonalityAssessment :one
INSERT INTO personality_assessments (
    cleaner_id,
    trust_score, morality_score, altruism_score,
    orderliness_score, dutifulness_score, self_discipline_score, cautiousness_score,
    integrity_avg, work_quality_avg,
    has_concerns, flagged_facets
) VALUES (
    $1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12
) RETURNING id, cleaner_id, trust_score, morality_score, altruism_score, orderliness_score, dutifulness_score, self_discipline_score, cautiousness_score, integrity_avg, work_quality_avg, has_concerns, flagged_facets, completed_at, created_at
`

type CreatePersonalityAssessmentParams struct {
	CleanerID           pgtype.UUID    `json:"cleaner_id"`
	TrustScore          int32          `json:"trust_score"`
	MoralityScore       int32          `json:"morality_score"`
	AltruismScore       int32          `json:"altruism_score"`
	OrderlinessScore    int32          `json:"orderliness_score"`
	DutifulnessScore    int32          `json:"dutifulness_score"`
	SelfDisciplineScore int32          `json:"self_discipline_score"`
	CautiousnessScore   int32          `json:"cautiousness_score"`
	IntegrityAvg        pgtype.Numeric `json:"integrity_avg"`
	WorkQualityAvg      pgtype.Numeric `json:"work_quality_avg"`
	HasConcerns         bool           `json:"has_concerns"`
	FlaggedFacets       []string       `json:"flagged_facets"`
}

func (q *Queries) CreatePersonalityAssessment(ctx context.Context, arg CreatePersonalityAssessmentParams) (PersonalityAssessment, error) {
	row := q.db.QueryRow(ctx, createPersonalityAssessment,
		arg.CleanerID,
		arg.TrustScore,
		arg.MoralityScore,
		arg.AltruismScore,
		arg.OrderlinessScore,
		arg.DutifulnessScore,
		arg.SelfDisciplineScore,
		arg.CautiousnessScore,
		arg.IntegrityAvg,
		arg.WorkQualityAvg,
		arg.HasConcerns,
		arg.FlaggedFacets,
	)
	var i PersonalityAssessment
	err := row.Scan(
		&i.ID,
		&i.CleanerID,
		&i.TrustScore,
		&i.MoralityScore,
		&i.AltruismScore,
		&i.OrderlinessScore,
		&i.DutifulnessScore,
		&i.SelfDisciplineScore,
		&i.CautiousnessScore,
		&i.IntegrityAvg,
		&i.WorkQualityAvg,
		&i.HasConcerns,
		&i.FlaggedFacets,
		&i.CompletedAt,
		&i.CreatedAt,
	)
	return i, err
}

const getPersonalityAnswersByAssessmentID = `-- name: GetPersonalityAnswersByAssessmentID :many
SELECT id, assessment_id, question_number, facet_code, is_reverse_keyed, raw_response, scored_value FROM personality_assessment_answers
WHERE assessment_id = $1
ORDER BY question_number ASC
`

func (q *Queries) GetPersonalityAnswersByAssessmentID(ctx context.Context, assessmentID pgtype.UUID) ([]PersonalityAssessmentAnswer, error) {
	rows, err := q.db.Query(ctx, getPersonalityAnswersByAssessmentID, assessmentID)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []PersonalityAssessmentAnswer
	for rows.Next() {
		var i PersonalityAssessmentAnswer
		if err := rows.Scan(
			&i.ID,
			&i.AssessmentID,
			&i.QuestionNumber,
			&i.FacetCode,
			&i.IsReverseKeyed,
			&i.RawResponse,
			&i.ScoredValue,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const getPersonalityAssessmentByCleanerID = `-- name: GetPersonalityAssessmentByCleanerID :one
SELECT id, cleaner_id, trust_score, morality_score, altruism_score, orderliness_score, dutifulness_score, self_discipline_score, cautiousness_score, integrity_avg, work_quality_avg, has_concerns, flagged_facets, completed_at, created_at FROM personality_assessments WHERE cleaner_id = $1
`

func (q *Queries) GetPersonalityAssessmentByCleanerID(ctx context.Context, cleanerID pgtype.UUID) (PersonalityAssessment, error) {
	row := q.db.QueryRow(ctx, getPersonalityAssessmentByCleanerID, cleanerID)
	var i PersonalityAssessment
	err := row.Scan(
		&i.ID,
		&i.CleanerID,
		&i.TrustScore,
		&i.MoralityScore,
		&i.AltruismScore,
		&i.OrderlinessScore,
		&i.DutifulnessScore,
		&i.SelfDisciplineScore,
		&i.CautiousnessScore,
		&i.IntegrityAvg,
		&i.WorkQualityAvg,
		&i.HasConcerns,
		&i.FlaggedFacets,
		&i.CompletedAt,
		&i.CreatedAt,
	)
	return i, err
}

const hasPersonalityAssessment = `-- name: HasPersonalityAssessment :one
SELECT EXISTS(
    SELECT 1 FROM personality_assessments WHERE cleaner_id = $1
) AS has_assessment
`

func (q *Queries) HasPersonalityAssessment(ctx context.Context, cleanerID pgtype.UUID) (bool, error) {
	row := q.db.QueryRow(ctx, hasPersonalityAssessment, cleanerID)
	var has_assessment bool
	err := row.Scan(&has_assessment)
	return has_assessment, err
}
